package fr.insee.rmes.onion.infrastructure.stamps;

import fr.insee.rmes.config.auth.security.UserDecoder;
import fr.insee.rmes.config.auth.user.User;
import fr.insee.rmes.onion.domain.exceptions.RmesException;
import fr.insee.rmes.onion.domain.model.Stamp;
import fr.insee.rmes.onion.domain.port.serverside.StampsService;
import org.springframework.stereotype.Service;
import fr.insee.rmes.config.auth.security.OpenIDConnectSecurityContext;

import java.util.List;

@Service
public record RmesStampsImpl(UserDecoder userDecoder) implements StampsService {


	public static final List<String> stamps = List.of(
			"DG33-C990",
			"DG57-C003",
			"DG57-C060",
			"DG57-C601",
			"DG57-C701",
			"DG57-C801",
			"DG75-A001",
			"DG75-A040",
			"DG75-A050",
			"DG75-B001",
			"DG75-C001",
			"DG75-C030",
			"DG75-C050",
			"DG75-C101",
			"DG75-C110",
			"DG75-C120",
			"DG75-C130",
			"DG75-C140",
			"DG75-C301",
			"DG75-C310",
			"DG75-C330",
			"DG75-C340",
			"DG75-C901",
			"DG75-C910",
			"DG75-C920",
			"DG75-C930",
			"DG75-C960",
			"DG75-D001",
			"DG75-D010",
			"DG75-D101",
			"DG75-D110",
			"DG75-D120",
			"DG75-D130",
			"DG75-D140",
			"DG75-D201",
			"DG75-D210",
			"DG75-D220",
			"DG75-D230",
			"DG75-D240",
			"DG75-D250",
			"DG75-D260",
			"DG75-D270",
			"DG75-D280",
			"DG75-D301",
			"DG75-D310",
			"DG75-D320",
			"DG75-D330",
			"DG75-E001",
			"DG75-E010",
			"DG75-E201",
			"DG75-E210",
			"DG75-E220",
			"DG75-E230",
			"DG75-E240",
			"DG75-E260",
			"DG75-E301",
			"DG75-E310",
			"DG75-E320",
			"DG75-E330",
			"DG75-E401",
			"DG75-E410",
			"DG75-E420",
			"DG75-E430",
			"DG75-E440",
			"DG75-F001",
			"DG75-F010",
			"DG75-F101",
			"DG75-F110",
			"DG75-F120",
			"DG75-F170",
			"DG75-F201",
			"DG75-F210",
			"DG75-F220",
			"DG75-F230",
			"DG75-F240",
			"DG75-F301",
			"DG75-F330",
			"DG75-F340",
			"DG75-F350",
			"DG75-F501",
			"DG75-F510",
			"DG75-F520",
			"DG75-F601",
			"DG75-F610",
			"DG75-F620",
			"DG75-G001",
			"DG75-G010",
			"DG75-G101",
			"DG75-G110",
			"DG75-G120",
			"DG75-G140",
			"DG75-G201",
			"DG75-G210",
			"DG75-G220",
			"DG75-G230",
			"DG75-G401",
			"DG75-G410",
			"DG75-G420",
			"DG75-G430",
			"DG75-G450",
			"DG75-H001",
			"DG75-H010",
			"DG75-H030",
			"DG75-H101",
			"DG75-H110",
			"DG75-H150",
			"DG75-H201",
			"DG75-H230",
			"DG75-H240",
			"DG75-H250",
			"DG75-H301",
			"DG75-H310",
			"DG75-H320",
			"DG75-H330",
			"DG75-H401",
			"DG75-H420",
			"DG75-H430",
			"DG75-H480",
			"DG75-L001",
			"DG75-L002",
			"DG75-L005",
			"DG75-L010",
			"DG75-L101",
			"DG75-L110",
			"DG75-L120",
			"DG75-L130",
			"DG75-L201",
			"DG75-L301",
			"DG75-L310",
			"DG75-L320",
			"DG75-L330",
			"DG75-L401",
			"DR13-DIR",
			"DR13-SAR",
			"DR13-SED",
			"DR13-SES",
			"DR13-SIN",
			"DR14-DIR",
			"DR14-ETB14",
			"DR14-ETB76",
			"DR14-SAR14",
			"DR14-SAR76",
			"DR14-SED14",
			"DR14-SED76",
			"DR14-SES14",
			"DR14-SES76",
			"DR14-SSNE",
			"DR20-DIR",
			"DR20-SAR",
			"DR20-SED",
			"DR20-SES",
			"DR25-DIR",
			"DR25-ETB21",
			"DR25-ETB25",
			"DR25-SAR21",
			"DR25-SAR25",
			"DR25-SED21",
			"DR25-SED25",
			"DR25-SES21",
			"DR25-SES25",
			"DR31-DIR",
			"DR31-ETB31",
			"DR31-ETB34",
			"DR31-SAR31",
			"DR31-SAR34",
			"DR31-SED31",
			"DR31-SED34",
			"DR31-SES31",
			"DR31-SES34",
			"DR35-DIR",
			"DR35-SAR",
			"DR35-SED",
			"DR35-SES",
			"DR44-DIR",
			"DR44-ESANE",
			"DR44-SAR",
			"DR44-SED",
			"DR44-SES",
			"DR44-SNDI",
			"DR44-SNSI",
			"DR45-DIR",
			"DR45-SAR",
			"DR45-SED",
			"DR45-SES",
			"DR45-SNDI",
			"DR59-DIR",
			"DR59-ETB59",
			"DR59-ETB80",
			"DR59-SAR59",
			"DR59-SAR80",
			"DR59-SED59",
			"DR59-SED80",
			"DR59-SES59",
			"DR59-SES80",
			"DR59-SIN",
			"DR59-SNDI",
			"DR67-DIR",
			"DR67-ETB51",
			"DR67-ETB54",
			"DR67-ETB67",
			"DR67-SAR51",
			"DR67-SAR54",
			"DR67-SAR67",
			"DR67-SED51",
			"DR67-SED54",
			"DR67-SED67",
			"DR67-SES51",
			"DR67-SES54",
			"DR67-SES67",
			"DR67-SNTDA",
			"DR67-SNTDA57",
			"DR69-DIR",
			"DR69-ETB63",
			"DR69-ETB69",
			"DR69-SAR63",
			"DR69-SAR69",
			"DR69-SED63",
			"DR69-SED69",
			"DR69-SERN69",
			"DR69-SES63",
			"DR69-SES69",
			"DR78-DIR",
			"DR78-SAR",
			"DR78-SED",
			"DR78-SES",
			"DR86-DIR",
			"DR86-ETB33",
			"DR86-ETB86",
			"DR86-ETB87",
			"DR86-SAR33",
			"DR86-SAR86",
			"DR86-SAR87",
			"DR86-SED33",
			"DR86-SED86",
			"DR86-SED87",
			"DR86-SES33",
			"DR86-SES86",
			"DR86-SES87",
			"DR971-DIR",
			"DR971-SAR",
			"DR971-SED",
			"DR971-SES",
			"DR971-ST971",
			"DR971-ST972",
			"DR971-ST973",
			"DR974-DIR",
			"DR974-SAR",
			"DR974-SED",
			"DR974-SES",
			"DR974-SR976",
			"SSM-DARES",
			"SSM-SSP",
			"SSM-DARES",
			"SSM-DEPP",
			"SSM-DESL",
			"SSM-DREES",
			"SSM-SDES",
			"SSM-SDSE",
			"SSM-MEOS",
			"SSM-OED",
			"SSM-DSEE",
			"SSM-SSMSI",
			"SSM-GF3C",
			"SSM-DSED",
			"SSM-DESSI",
			"SSM-SIES",
			"SSM-DEPS",
			OpenIDConnectSecurityContext.TIMBRE_ANONYME
	);


	@Override
	public List<String> getStamps() {
		return stamps;
	}

	@Override
	public Stamp findStampFrom(Object principal) throws RmesException {
		return this.userDecoder.fromPrincipal(principal).map(User::stamp).orElse(null);
	}

}
